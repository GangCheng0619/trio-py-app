Avoid O(n**3) scaling of windows socket cancellation